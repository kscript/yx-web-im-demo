<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>云信 Web Demo</title>
	<link rel="icon" href="images/icon.ico" type="image/x-icon" />
	<style>
		*{padding: 0; margin: 0;}
		html, body {height: 100%; overflow: auto; background: #4e5359 no-repeat no-repeat 0 0; background-size: cover; background-position: 50% 50%; color: #3a4a59; font: 14px/1.5 Helvetica, Arial, Tahoma'微软雅黑';}
		body.demo .left-panel{box-shadow: 0 2px 6px #313131!important;}
	</style>
	<link rel="stylesheet" href="css/main.css" />
</head>

<body class="demo">
	<div id="nim" class="wrapper box-sizing mini">
		<div class="btn j-btn-chat btn-chat2">聊天</div>
		<div class="content">
			<div class="left-panel radius5px" id="left-panel">
				<div class="hide loading" id="loading"></div>
        <!-- 功能tab -->
				<div class="item" id="sessionsWrap" data-type="sessions">
					<!-- 最近联系人 -->
					<div class="list">
						<div class="btn j-btn-chat btn-chat1">
							<div class="el-icon"></div>
						</div>
						<div id="sessions">
							<p>正在获取最近联系人...</p>
						</div>
					</div>
				</div>
			</div>
			<div class="chatVernier" id="chatVernier">
				<span class="radius-circle hide"></span>
			</div>
			<div class="right-panel hide radius5px" id="rightPanel">
				<!-- 聊天面板 -->
				<div class="chat-box show-netcall-box" id="chatBox">
					<div class="title" id="chatTitle">
						<img src="" width="56" height="56" class="radius-circle img" id="headImg" />
						<span id="nickName"></span>
						<div class="cloudMsg tc radius4px" data-record-id="" id="cloudMsg">
							<i class="icon icon-team-info"></i>
							<p>云记录</p>
						</div>
						<div class="team-info hide tc radius4px" data-team-id="" id="teamInfo">
							<i class="icon icon-team-info"></i>
							<p>资料</p>
						</div>
					</div>
					<div id="whiteboard"></div>
					<div class="chat-content box-sizing" id="chatContent">
						<!-- 聊天记录 -->
					</div>
					<div class="u-chat-notice">您已退出</div>
					<div class="chat-mask"></div>
					<div class="chat-editor box-sizing" id="chatEditor" data-disabled="1">
						<div id="emojiTag" class="m-emojiTag"></div>
						<a class="chat-btn u-emoji" id="showEmoji"></a>
						<span class="chat-btn msg-type hide" id="chooseFileBtn">
							<a class="icon icon-file" data-type="file"></a>
						</span>
						<!-- 在netcall_ui.js的fn.whenOpenChatBox中隐藏 -->
						<a class="chat-btn u-whiteboard" id="showWhiteboard">&nbsp;</a>
						<textarea id="messageText" class="chat-btn msg-input box-sizing radius5px p2p" rows="1" autofocus="autofocus" maxlength="500"></textarea>
						<span class="chat-context" id="showTeamMsgReceipt">
							<label for="needTeamMsgReceipt">
							<input id="needTeamMsgReceipt" type="checkbox" name="needTeamMsgReceipt" />回执</label>
						</span>
						<a class="btn-send radius5px" id="sendBtn">发送</a>
						<form action="#" id="uploadForm">
							<input multiple="multiple" type="file" name="file" id="uploadFile" class="hide" />
						</form>
					</div>
				</div>
			</div>
			<div class="right-panel hide radius5px devices-container" id="devices">
				<!-- 设备管理面板 -->
				<div class="info-box">
					<div class="title tc">
						<button class="btn back-btn radius5px" id="backBtn2">返回</button>多端登录管理
					</div>
					<div class="content">
						<div class="main">
							<div class="pic"></div>
							<div class="mobile hide">
								<p>云信手机版</p>
								<a class="u-kick j-kickMoblie">下线</a>
							</div>
							<div class="pc hide">
								<p>云信PC版</p>
								<a class="u-kick j-kickPc">下线</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- 云记录 -->
		<div class="cloud-msg-container hide" id="cloudMsgContainer">
			<div class="info-box">
				<div class="title tc">
					<button class="btn back-btn radius5px j-backBtn">返回</button>云记录
				</div>
				<div class="info-content">
					<div class="u-status tc"><span class="radius5px">正在加载中……</span></div>
					<ul id="cloudMsgList" class="f-cb">	
					</ul>
				</div>
			</div>
		</div>
	</div>
	<script src="js/module/jquery-1.11.3.min.js"></script>
	<script src="js/require.js"></script>
	<script>
		var imInit = false;
		$("#nim .j-btn-chat").on("click", function(){
			if(!imInit){
				imInit = true;
				$.ajax({
					url: 'http://localhost:3001/iminfo',
					type: 'POST',
					dataType: 'json',
					success: function(response){
						localStorage.setItem('uid', response.data.uid);
						localStorage.setItem('token', response.data.token);
						localStorage.setItem('appkey', response.data.appkey);
						requirejs([
							'js/main-built.js'
						], function(){
							$("#rightPanel,#chatVernier span").addClass("hide");
							$("#nim").toggleClass("mini");
							requirejs([
								'global'
							], function(global){
								// 模块公共变量
								console.log(global());
							})
						});
					}
				});
			} else {
				$("#rightPanel,#chatVernier span").addClass("hide");
				$("#nim").toggleClass("mini");
			}
		});
	</script>
</body>

</html>